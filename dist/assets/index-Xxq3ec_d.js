import{j as e,r as V,a as i,u as H,d as v,P as f,R as T,Q as D,L as B,I as J}from"./index-rGFShE4b.js";const X="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='48'%20viewBox='0%20-960%20960%20960'%20width='48'%3e%3cpath%20d='M726.986-74.5q-49.638%200-84.562-35.03-34.924-35.031-34.924-84.708%200-6.751%201.5-16.639%201.5-9.887%204.5-18.08L319.348-399.935q-15.718%2017.718-38.518%2028.576-22.8%2010.859-46.723%2010.859-49.836%200-84.722-34.938-34.885-34.938-34.885-84.576%200-49.638%2034.885-84.562%2034.886-34.924%2084.722-34.924%2023.923%200%2045.723%209.359%2021.8%209.358%2039.518%2027.076L613.5-732.043q-3-7.311-4.5-16.514-1.5-9.204-1.5-17.535%200-49.54%2034.938-84.474%2034.938-34.934%2084.576-34.934%2049.638%200%2084.562%2034.938t34.924%2084.576q0%2049.638-34.885%2084.562-34.886%2034.924-84.722%2034.924-24.277%200-46.419-7.612-22.141-7.612-37.583-25.344L348.5-516.957q2.239%208.24%203.62%2019.104%201.38%2010.864%201.38%2018.094%200%207.231-1.38%2015.234-1.381%208.003-3.62%2016.482l294.391%20166.499q15.442-14.732%2036.26-23.344%2020.819-8.612%2047.742-8.612%2049.836%200%2084.722%2034.938%2034.885%2034.938%2034.885%2084.576%200%2049.638-34.938%2084.562T726.986-74.5Zm.049-637.5Q750-712%20765.5-727.535q15.5-15.535%2015.5-38.5T765.465-804.5q-15.535-15.5-38.5-15.5T688.5-804.465q-15.5%2015.535-15.5%2038.5t15.535%2038.465q15.535%2015.5%2038.5%2015.5Zm-493%20286Q257-426%20272.5-441.535q15.5-15.535%2015.5-38.5T272.465-518.5q-15.535-15.5-38.5-15.5T195.5-518.465q-15.5%2015.535-15.5%2038.5t15.535%2038.465q15.535%2015.5%2038.5%2015.5Zm493%20286Q750-140%20765.5-155.535q15.5-15.535%2015.5-38.5T765.465-232.5q-15.535-15.5-38.5-15.5T688.5-232.465q-15.5%2015.535-15.5%2038.5t15.535%2038.465q15.535%2015.5%2038.5%2015.5ZM727-766ZM234-480Zm493%20286Z'%20/%3e%3c/svg%3e",ee="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='%23F45B69'%20height='48'%20viewBox='0%20-960%20960%20960'%20width='48'%3e%3cpath%20d='M181.913-182.152h44.239l459.804-458.804-43.761-44-460.282%20459.043v43.761Zm-67.891%2068.13V-253.5l574.521-573.761q8.239-8.478%2019.803-13.217%2011.563-4.74%2024.11-4.74%2011.479%200%2022.957%204.74%2011.478%204.739%2021.196%2012.978l51.891%2051.174q9.239%209.717%2013.478%2021.315%204.24%2011.598%204.24%2023.315%200%2011.718-4.74%2023.696-4.739%2011.978-12.978%2020.457L253.739-114.022H114.022Zm661.152-618.674-41.239-41.478%2041.239%2041.478Zm-110.979%2069.501-22-21.761%2043.761%2044-21.761-22.239Z'/%3e%3c/svg%3e",te="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='%23F45B69'%20height='48'%20viewBox='0%20-960%20960%20960'%20width='48'%3e%3cpath%20d='M846.218-685.63v503.478q0%2027.599-20.337%2047.865-20.336%2020.265-48.033%2020.265H182.152q-27.599%200-47.865-20.265-20.265-20.266-20.265-47.865v-595.696q0-27.697%2020.265-48.033%2020.266-20.337%2047.865-20.337H685.63L846.218-685.63Zm-68.37%2030.587L655.043-777.848H182.152v595.696h595.696v-472.891ZM479.765-247.152q43.235%200%2073.735-30.265t30.5-73.5q0-43.235-30.265-73.735-30.264-30.5-73.5-30.5-43.235%200-73.735%2030.264-30.5%2030.265-30.5%2073.5%200%2043.236%2030.265%2073.736%2030.264%2030.5%2073.5%2030.5ZM235.152-581.848h358v-143h-358v143Zm-53-73.195v472.891-595.696%20122.805Z'/%3e%3c/svg%3e",se="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='white'%20height='48'%20viewBox='0%20-960%20960%20960'%20width='48'%3e%3cpath%20d='M182.152-114.022q-27.599%200-47.865-20.265-20.265-20.266-20.265-47.865v-595.696q0-27.697%2020.265-48.033%2020.266-20.337%2047.865-20.337h298.283v68.37H182.152v595.696h298.283v68.13H182.152Zm481.457-182.369-48.74-48.5%20100.805-101.044H358.565v-68.13h355.109L612.869-615.109l48.74-48.5L846.218-479%20663.609-296.391Z'/%3e%3c/svg%3e",ne="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='%23F45B69'%20height='48'%20viewBox='0%20-960%20960%20960'%20width='48'%3e%3cpath%20d='M259.087-114.022q-28.448%200-48.409-19.89-19.961-19.891-19.961-48.24v-565.935h-45.065v-68.131h198.283v-34.304h271.891v34.304h198.522v68.131h-45.065v565.935q0%2027.599-20.336%2047.865-20.336%2020.265-48.034%2020.265H259.087Zm441.826-634.065H259.087v565.935h441.826v-565.935ZM363.891-266.239h64.066v-399h-64.066v399Zm168.152%200h64.305v-399h-64.305v399ZM259.087-748.087v565.935-565.935Z'/%3e%3c/svg%3e";function ae(s){return e.jsx(e.Fragment,{children:e.jsxs("div",{id:"toast",className:s.type?s.type:"",children:[e.jsx("img",{id:"img",src:V}),e.jsx("div",{id:"desc",children:s.message||"We're sorry but an error occured!"})]})})}function ie(s){const[h,u]=i.useState(!1);return i.useEffect(()=>{s.display&&u(!1)},[s.display]),e.jsx(e.Fragment,{children:e.jsx("div",{className:s.display&&!h?"conf-dialog":"conf-dialog-hidden",children:e.jsxs("div",{children:[e.jsx("h4",{children:"Confirmation"}),e.jsx("p",{children:s.text?s.text:"Are you sure you want to do that?"}),e.jsxs("div",{children:[e.jsx("button",{className:"conf-can-btn",onClick:()=>{s.handleCancelation(),u(!0)},children:"Cancel"}),e.jsx("button",{className:"conf-btn",onClick:()=>{s.handleConfirmation(),u(!0)},children:"Confirm"})]})]})})})}const q="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='%23F45B69'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%3e%3cpath%20d='M640-520v-80h240v80H640Zm-280%2040q-66%200-113-47t-47-113q0-66%2047-113t113-47q66%200%20113%2047t47%20113q0%2066-47%20113t-113%2047ZM40-160v-112q0-34%2017.5-62.5T104-378q62-31%20126-46.5T360-440q66%200%20130%2015.5T616-378q29%2015%2046.5%2043.5T680-272v112H40Zm80-80h480v-32q0-11-5.5-20T580-306q-54-27-109-40.5T360-360q-56%200-111%2013.5T140-306q-9%205-14.5%2014t-5.5%2020v32Zm240-320q33%200%2056.5-23.5T440-640q0-33-23.5-56.5T360-720q-33%200-56.5%2023.5T280-640q0%2033%2023.5%2056.5T360-560Zm0-80Zm0%20400Z'/%3e%3c/svg%3e",re="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20fill='white'%20height='24'%20viewBox='0%20-960%20960%20960'%20width='24'%3e%3cpath%20d='m256-200-56-56%20224-224-224-224%2056-56%20224%20224%20224-224%2056%2056-224%20224%20224%20224-56%2056-224-224-224%20224Z'/%3e%3c/svg%3e";var j={BASE_URL:"/rubium/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function ce(s){const[h,u]=i.useState(!1),[S,y]=i.useState("");H(),i.useEffect(()=>{s.display&&u(!1)},[s.display]),i.useEffect(()=>{s.noteId&&m()},[s.noteId]);const[a,E]=i.useState(null);function m(){v.getDocument(j.VITE_DATABASE_ID,j.VITE_NOTES_COLLECTION_ID,s.noteId).then(c=>{E(c),x(a.$permissions.includes(f.read(T.any())))}).catch(()=>{})}const[p,x]=i.useState(!1);function _(){const c=a.$permissions;v.updateDocument(j.VITE_DATABASE_ID,j.VITE_NOTES_COLLECTION_ID,a.$id,void 0,[...c,f.read(T.any())]).then(o=>{x(!0)}).catch(()=>{})}function $(){var c=a.$permissions;c=c.filter(function(o){return o!==f.read(T.any())}),v.updateDocument(j.VITE_DATABASE_ID,j.VITE_NOTES_COLLECTION_ID,a.$id,void 0,c).then(o=>{x(!1)}).catch(()=>{})}function d(c){const o=a.$permissions;o.push(f.read(T.user(c))),o.push(f.update(T.user(c))),o.push(f.delete(T.user(c))),v.updateDocument(j.VITE_DATABASE_ID,j.VITE_NOTES_COLLECTION_ID,a.$id,void 0,o).then(b=>{m()}).catch(()=>{})}return e.jsx(e.Fragment,{children:e.jsx("div",{className:s.display&&!h?"share-dialog":"share-dialog-hidden",children:e.jsxs("div",{children:[e.jsxs("div",{className:"sh-top",children:[e.jsx("h4",{children:"Share this note"}),e.jsx("img",{onClick:()=>{s.onClose(),u(!0)},src:re})]}),e.jsx("p",{children:"You can quickly share a note with a friend to easily collaborate by providing the email associated to their Rubium account."}),e.jsxs("div",{className:"sh-search",children:[e.jsx("input",{placeholder:"Enter the email to share with",value:S,onChange:c=>{y(c.target.value)}}),e.jsx("button",{className:"share-btn",onClick:()=>{d(S)},children:"Add"})]}),e.jsxs("div",{className:"shared-list",children:[e.jsxs("div",{className:"sh-list-item",children:[e.jsx("img",{className:"sh-profile",src:"//unsplash.it/20/20"}),e.jsx("p",{children:"teste@gmail.com"}),e.jsx("img",{className:"sh-remove",src:q})]}),e.jsxs("div",{className:"sh-list-item",children:[e.jsx("img",{className:"sh-profile",src:"//unsplash.it/20/21"}),e.jsx("p",{children:"manuelsoares@hotmail.com"}),e.jsx("img",{className:"sh-remove",src:q})]}),e.jsxs("div",{className:"sh-list-item",children:[e.jsx("img",{className:"sh-profile",src:"//unsplash.it/21/20"}),e.jsx("p",{children:"rato@esquilo.casca"}),e.jsx("img",{className:"sh-remove",src:q})]}),e.jsxs("div",{className:"sh-list-item",children:[e.jsx("img",{className:"sh-profile",src:"//unsplash.it/21/21"}),e.jsx("p",{children:"noddy@ruca.pt"}),e.jsx("img",{className:"sh-remove",src:q})]})]}),e.jsx("br",{}),e.jsx("p",{children:"You can also publish it on the web, creating a share-able link"}),p?e.jsx("button",{className:"share-can-btn",onClick:()=>{$()},children:"Un-Publish"}):e.jsx("button",{className:"share-can-btn",onClick:()=>{_()},children:"Publish"})]})})})}var g={BASE_URL:"/rubium/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function le(){const s=H(),[h,u]=i.useState(!1),[S,y]=i.useState(0);i.useState([]);const[a,E]=i.useState(""),[m,p]=i.useState([]),[x,_]=i.useState(""),[$,d]=i.useState(!0),[c,o]=i.useState(!0);i.useEffect(()=>{w()},[]),i.useEffect(()=>{w()},[x]);function b(t){_(t.target.value)}function A(t){t=="draft"&&E({$id:"draft",title:"New Note",content:""}),o(!0),v.getDocument(g.VITE_DATABASE_ID,g.VITE_NOTES_COLLECTION_ID,t).then(n=>{E(n),o(!1)}).catch(()=>{o(!1)})}function w(t=!1){d(!0);const n=x.length>0?[D.search("title",x),D.select(["$id","$updatedAt","title","owner"]),D.orderDesc("$updatedAt")]:[D.select(["$id","$updatedAt","title","owner"]),D.orderDesc("$updatedAt")];v.listDocuments(g.VITE_DATABASE_ID,g.VITE_NOTES_COLLECTION_ID,n).then(r=>{p(r.documents),(a==""||t)&&O(r.documents[0]),d(!1)}).catch(()=>{d(!1)})}function k(){if(d(!0),a.$id=="draft"){const t=T.user(s.current.$id),n=[f.read(t),f.update(t),f.delete(t)];let r=document.getElementById("note");const l={title:a.title,owner:s.current.$id,content:r.innerHTML};p(m.filter(I=>I.$id!=="draft")),v.createDocument(g.VITE_DATABASE_ID,g.VITE_NOTES_COLLECTION_ID,J.unique(),l,n).then(I=>{N("Saved new note successfully!","success"),w(!0)}).catch(()=>{N("Error saving new note...","error"),d(!1)})}else v.updateDocument(g.VITE_DATABASE_ID,g.VITE_NOTES_COLLECTION_ID,a.$id,{title:a.title,content:document.getElementById("note").innerHTML}).then(t=>{N("Changes saved successfully!","success"),w()}).catch(()=>{N("Error saving changes...","error")})}function R(t){d(!0),t.$id=="draft"?(p(m.filter(n=>n.$id!=="draft")),N("Draft discarded successfully!","success"),w(!0)):v.deleteDocument(g.VITE_DATABASE_ID,g.VITE_NOTES_COLLECTION_ID,t.$id).then(n=>{N("Note deleted successfully!","success"),w(!0)}).catch(()=>{N("Error deleting note...","error"),d(!1)})}function F(){m.find(t=>t.$id==="draft")||(d(!0),u(!0),N("Created a new draft!","info"),p([...m,{$id:"draft",title:"New Note",content:""}]),A("draft"),d(!1))}function O(t){t.$id!==a.$id&&(_(""),u(!1),A(t.$id))}function P(t){if(t.length>32)return;E({...a,title:t});let n=m.filter(r=>r.$id===a.$id);n[0].title=t}function Z(t){console.log(t),E({...a,content:t})}function Q(t){const n=new Date(t),r=new Date,l=new Date;l.setDate(l.getDate()-1);let I=n.getDate()+"/"+(n.getMonth()+1)+"/"+n.getFullYear();return n.toDateString()==r.toDateString()?I="Today at ":l.toDateString()==n.toDateString()&&(I="Yesterday at "),I+n.getHours()+":"+n.getMinutes()}function U(){let t=Math.round(Math.random()*200+100),n=Math.round(Math.random()*200+100);return`//unsplash.it/${t}/${n}`}function Y(t){let n=document.getElementById("note");var r=K(n);y(r),(t.key=="Enter"||t.key==" ")&&h&&(n.innerHTML.includes("!random")&&Z(n.innerHTML.replace("!random",`<img src='${U()}'/>`)),n.innerHTML.includes("--")&&Z(n.innerHTML.replace("--","<hr class='rounded'><br/>")))}function K(t){const r=window.getSelection().getRangeAt(0),l=r.cloneRange();return l.selectNodeContents(t),l.setEnd(r.endContainer,r.endOffset),l.toString().length}const[W,z]=i.useState("");function N(t,n){z(t);var r=document.getElementById("toast");const l="show "+n;r.className=l,setTimeout(function(){r.className=r.className.replace(l,"")},4900)}const[C,L]=i.useState(null),[G,M]=i.useState(!1);return e.jsxs("div",{className:"app",children:[e.jsx(ae,{message:W}),e.jsx(ce,{display:G,noteId:a.$id,onClose:()=>{M(!1)}}),e.jsx(ie,{display:C!==null,text:`Are you sure you want to delete the note named
 "${C&&C.title}"?`,handleCancelation:()=>{L(null)},handleConfirmation:()=>{R(C),L(null)}}),e.jsxs("div",{className:"sidebar",children:[e.jsxs("div",{className:"side-title",children:[e.jsx("img",{src:V}),e.jsxs("p",{children:[e.jsx("strong",{children:s.current&&s.current.name+"'s"}),e.jsx("br",{}),"Rubium"]})]}),e.jsxs("div",{className:"note-create",children:[e.jsx("button",{onClick:()=>{F()},children:"+"}),e.jsx("input",{type:"text",placeholder:"Search notes...",className:"side-search",value:x,onChange:b})]}),$?e.jsx(B,{}):m.length!==0?m.map(t=>e.jsxs("div",{className:`side-item ${a.$id==t.$id?"side-item-selected":""}`,onClick:()=>{O(t)},children:[e.jsxs("p",{children:[t.title,e.jsxs("a",{className:t.$id=="draft"?"draft":s.current&&t.owner==s.current.$id?"private":"shared",children:[" ",s.current&&t.owner==s.current.$id||t.$id=="draft"?t.$id=="draft"?"Draft Note":Q(t.$updatedAt):"Shared with me"," "]})]}),e.jsx("img",{onClick:()=>{L(a)},src:ne})]})):e.jsx(e.Fragment,{}),e.jsxs("button",{className:"side-logout",type:"button",onClick:async()=>{await s.logout()},children:["Logout ",e.jsx("img",{src:se})]})]}),e.jsxs("div",{className:"main-div",children:[e.jsx("div",{className:"main-controls",children:c?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[e.jsx("a",{children:S}),a.owner==s.current.$id||a.$id=="draft"?e.jsx("img",{className:"edit-icon",onClick:()=>{h&&k(),u(!h)},src:h?te:ee}):e.jsx(e.Fragment,{}),"Edit/Save",a.owner==s.current.$id?e.jsx("img",{className:"share-icon",onClick:()=>{M(!0)},src:X}):e.jsx(e.Fragment,{}),"Share"]})}),c?e.jsx(B,{}):e.jsxs(e.Fragment,{children:[e.jsx("p",{style:{position:"absolute",color:"gray",fontSize:"10px"},children:a.$id}),e.jsx("input",{className:"note-title",disabled:!h,type:"text",value:a.title,onChange:t=>{P(t.target.value)}}),e.jsx("div",{id:"note",dangerouslySetInnerHTML:{__html:a.content||""},className:"note-content",contentEditable:h,onKeyUp:t=>{Y(t)}})]})]})]})}export{le as default};
